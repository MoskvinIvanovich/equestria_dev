on_actions = {

  #Not run on a specific country.
  on_startup = {
    effect = {
      if = {
        limit = { is_historical_focus_on = no }
        random_list = {
          90 = {

          }
          10 = {
            set_global_flag = EQS_evil_celestia
          }
        }
      }
      every_country = {
        limit = { is_generic_race = yes }
        set_technology = { generic_race = 1 }
      }
      ### Development ####
      every_country = {
        limit = { NOT = { is_on_equestrian_continent = yes } }
        if = {
          limit = {
            num_of_civilian_factories > 2
            has_tech = melee_weapons1
            NOT = { owns_big_griffon_city = yes }
            NOT = { owns_major_griffon_city = yes }
          }
          add_ideas = better_science_base
          else = {
            if = {
            limit = { owns_big_griffon_city = yes
            }
            add_ideas = big_science_base
            else = {
              if = {
              limit = { owns_major_griffon_city = yes
              }
              add_ideas = proper_science_base
              else = {
                if = {
                limit = { NOT = { owns_major_griffon_city = yes }
                NOT = { owns_big_griffon_city = yes }
                OR = {
                NOT = { has_tech = melee_weapons1 }
                NOT = { num_of_civilian_factories > 2 }
                }
                is_griffon_continent_country = yes
                }
                add_ideas = poor_science_base
                }
              }
              }
            }
            }
          }
        }
      }

      every_country = {
        limit = {
          OR = {
            is_on_equestrian_continent = yes
            has_idea = dummy_idea_science
            NOT = {
              has_idea_with_trait = science_idea
            }
          }
        }
        add_ideas = proper_science_base
      }

      every_country = {
        limit = {
          OR = {
            has_idea = dummy_idea_society
            NOT = {
              has_idea_with_trait = society_idea
            }
          }
        }
        if = {
          limit = { is_griffon_continent_country = yes }
          add_ideas = outdated_industry
          else = { add_ideas = modern_society }
        }
      }

      ### Development End ####
      EQS = {
        set_country_flag = manpower_laws_blocked
        set_country_flag = economic_laws_blocked
        set_country_flag = { flag = celestia_evil_meter value = 0 }
      }

    }
  }
  #FROM is war target
  on_declare_war = {
  effect = {
    if = {
      limit = {
        OR = {
          tag = EQS
          FROM = { tag = EQS }
        }
      }
      clr_country_flag = manpower_laws_blocked
      clr_country_flag = economic_laws_blocked
      FROM = {
        clr_country_flag = manpower_laws_blocked
        clr_country_flag = economic_laws_blocked
      }
    }
    if = {
      limit = {
        has_civil_war = yes
        original_tag = FROM
        FROM = { original_tag = ROOT }
        OR = {
          has_idea = dummy_idea_society
          #has_idea = modern_society
          NOT = { has_idea_with_trait = society_idea }
        }
        FROM = {
          OR = {
            has_idea = outdated_industry
            has_idea = pre_industrial_society
            has_idea = agrarian_society
            has_idea = tribal_society
            has_idea = detached_country
          }
        }
      }
      hidden_effect = {
        FROM = { ROOT = { transfer_society_ideas = yes } }
      }
      else = {
        hidden_effect = { add_ideas = modern_society }
      }
    }
    if = {
      limit = {
        has_civil_war = yes
        original_tag = FROM
        FROM = { original_tag = ROOT }
        OR = {
          has_idea = dummy_idea_science
          #has_idea = proper_science_base
          NOT = { has_idea_with_trait = science_idea }
        }
        FROM = {
          OR = {
            has_idea = poor_science_base
            has_idea = better_science_base
            has_idea = big_science_base
          }
        }
      }
      hidden_effect = { FROM = { ROOT = { transfer_science_ideas = yes } } }
      else = {
        hidden_effect = { add_ideas = proper_science_base }
      }
    }
    }
  }
  #FROM is state the nuke got dropped on
  on_nuke_drop = {

    effect = {
      FROM = {
        decrease_population_on_nuke = yes
      }
      if = {
        limit = {
          OR = {
          tag = EQS
          tag = SOL }
          FROM = { state = 251 }
          NOT = { has_country_flag = nuked_the_hive }
        }
        news_event = { id = news.50 days = 1}
        set_country_flag = nuked_the_hive
      }
    }
  }

  #used when puppeting in a peace conference
	#ROOT = nation being puppeted, FROM = overlord
  on_puppet = {
    effect = {
      if = {
        limit = {
          original_tag = EQS
          has_country_flag = EQS_CRY_has_twilight
          FROM = { original_tag = SOL }
        }
        FROM = { news_event = solarempire.22 }
      }
      if = {
        limit = {
          original_tag = CRY
          has_country_flag = EQS_CRY_has_twilight
          FROM = { original_tag = SOL }
        }
        FROM = { news_event = solarempire.26 }
      }
      if = {
        limit = {
          FROM = {
            is_ai = yes
            original_tag = GRF
           }
          ROOT = {
            original_tag = GFF
          }
        }
        FROM = { annex_country =  { target = ROOT } }
      }
      if = {
        limit = {
          FROM = {
            is_ai = yes
            original_tag = JER
           }
          ROOT = {
            original_tag = HEL
          }
        }
        FROM = { country_event = aquileia.34 }
      }
	  if = {
        limit = {
          FROM = {
            is_ai = yes
            original_tag = JER
           }
          ROOT = {
            original_tag = FLO
          }
        }
        FROM = { country_event = aquileia.35 }
      }
	  if = {
        limit = {
          FROM = {
            is_ai = yes
            original_tag = JER
           }
          ROOT = {
            original_tag = POM
          }
        }
        FROM = { country_event = aquileia.36 }
      }
	  if = {
        limit = {
          FROM = {
            is_ai = yes
            original_tag = JER
           }
          ROOT = {
            original_tag = AET
          }
        }
        FROM = { country_event = aquileia.37 }
      }
	  if = {
        limit = {
          FROM = {
            is_ai = yes
            original_tag = JER
           }
          ROOT = {
            original_tag = FEZ
          }
        }
        FROM = { country_event = aquileia.38 }
      }
      if = {
        limit = {
          FROM = {
            is_ai = yes
            is_eqs_civil_war_tag = yes
            NOT = { original_tag = JUN }
           }
          ROOT = {
            is_ai = yes
            is_eqs_civil_war_tag = yes
            NOT = { original_tag = JUN }
          }
        }
        FROM = { annex_country =  { target = ROOT } }
      }
      if = {
        limit = {
          original_tag = CHN
          FROM = {
            original_tag = EQS
            is_ai = yes
            has_government = democratic
          }
          OR = {
            OLE = {
              has_country_flag = OLE_was_annexed
            }
            FROM = {
              any_owned_state = {
                is_core_of = OLE
              }
            }
          }
          any_owned_state = {
            is_core_of = OLE
          }
        }
        every_owned_state = {
          limit = { is_core_of = OLE }
          OLE = { transfer_state = PREV }
        }
        EQS = {
          every_owned_state = {
            limit = { is_core_of = OLE }
            OLE = { transfer_state = PREV }
          }
        }
        OLE = {
          set_politics = { ruling_party = democratic elections_allowed = no }
          set_political_party = { ideology = democratic popularity = 1.0 }
          clr_country_flag = OLE_was_annexed
        }
        EQS = {
          if = {
            limit = { OLE = { NOT = { is_subject_of = EQS } } }
            puppet = OLE
          }
        }
      }
      if = {
        limit = {
          FROM = {
            original_tag = CHN
            has_government = fascism
           }
        }
        if = {
          limit = { original_tag = OLE }
          country_event = { id = olenia.718 }
          break = yes
        }
        if = {
          limit = { original_tag = PLB }
          country_event = { id = changelings.900 }
          break = yes
        }
        if = {
          limit = { original_tag = GRF }
          country_event = { id = changelings.902 }
          break = yes
        }
        if = {
          limit = { original_tag = PNG }
          country_event = { id = changelings.901 }
          break = yes
        }
        if = {
          limit = { original_tag = STL }
          country_event = { id = changelings.903 }
          break = yes
        }
        if = {
          limit = { original_tag = BUF }
          country_event = { id = changelings.904 }
          break = yes
        }
        if = {
          limit = { original_tag = DRG }
          country_event = { id = changelings.905 }
          break = yes
        }
        if = {
          limit = { original_tag = GFF }
          country_event = { id = changelings.906 }
          break = yes
        }
        if = {
          limit = { original_tag = GFF }
          country_event = { id = changelings.906 }
          break = yes
        }
        if = {
          limit = { original_tag = OLE }
          country_event = { id = olenia.718 }
          break = yes
        }
        if = {
          limit = { original_tag = CRY }
          country_event = { id = crystalemp.23 }
          break = yes
        }
        if = {
          limit = { original_tag = EQS }
          country_event = { id = equestriachn.3 }
          break = yes
        }
        if = {
          limit = { original_tag = STG }
          country_event = { id = stalliongrad.98 }
          break = yes
        }
        if = {
          limit = { original_tag = YAK }
          country_event = { id = yakistan.12 }
          break = yes
        }
        if = {
          limit = { original_tag = JAK }
          country_event = { id = yakistan.13 }
          break = yes
        }
      }
      if = {
        limit = { original_tag = CHN overlord = { has_government = fascism } }
        country_event = { id = solarempire.906 }
      }
      if = {
        limit = {
          FROM = {
            original_tag = SOL
            has_government = fascism
           }
        }
        if = {
          limit = { original_tag = CRY }
          FROM = {
            set_country_flag = SOL_twilight_unavailable
            set_country_flag = SOL_twilight_governor
            set_autonomy = { target = ROOT autonomy_state = autonomy_reichskommissariat }
          }
          set_cosmetic_tag = CRY_SOL
          add_autonomy_ratio = { value = -0.20 }
          set_country_flag = CRY_solar_governorship
          set_party_name = { ideology = fascism long_name = SOL_fascism_party_long name = SOL_fascism_party }
          if = {
            limit = { NOT = { has_global_flag = SOL_twilight_converted } }
            create_country_leader = {
              name = "Nameless Busybody"
              #desc = "TWILIGHT_DESC"
              #picture = "TwilightSunrise.tga"
              expire = "1965.1.1"
              ideology = fascism_ideology
              traits = {
              }
            }
            else = {
              create_country_leader = {
                name = "Grand Inquisitor Sunrise Sparkle"
                #desc = "TWILIGHT_DESC"
                picture = "TwilightSunrise.tga"
                expire = "1965.1.1"
                ideology = fascism_ideology
                traits = {
                  lady_inquisitor
                }
              }
            }
          }
          break = yes
        }
      }
      if = {
        limit = {
          FROM = {
            OR = {
              original_tag = EQS
              original_tag = SOL
            }
           }
        }
        if = {
          limit = {
            original_tag = CRY
            NOT = {
              has_idea = equestrian_overlord
              has_idea = equestrian_overlord2
            }
          }
          if = {
            limit = { has_completed_focus = CRY_eqsengineers }
            add_ideas = equestrian_overlord2
            else = {
              add_ideas = equestrian_overlord
            }
          }
        }
      }
      if = {
        limit = {
          original_tag = EQC
          FROM = {
            OR = {
              original_tag = EQS
              original_tag = NLR
              original_tag = SOL
            }
          }
        }
        country_event = equestriancolony.1
      }
    }
  }

  #used when puppeting through the occupied territories menu during peace time (or when releasing from non-core but owned territory, f.e. Britain releasing Egypt)
	#ROOT = nation being released, FROM = overlord
	on_release_as_puppet = {
		effect = {
      if = {
        limit = {
          FROM = {
            original_tag = CHN
            has_government = fascism
           }
        }
        if = {
          limit = { original_tag = OLE }
          country_event = { id = olenia.718 }
          break = yes
        }
        if = {
          limit = { original_tag = PLB }
          country_event = { id = changelings.900 }
          break = yes
        }
        if = {
          limit = { original_tag = GRF }
          country_event = { id = changelings.902 }
          break = yes
        }
        if = {
          limit = { original_tag = PNG }
          country_event = { id = changelings.901 }
          break = yes
        }
        if = {
          limit = { original_tag = STL }
          country_event = { id = changelings.903 }
          break = yes
        }
        if = {
          limit = { original_tag = BUF }
          country_event = { id = changelings.904 }
          break = yes
        }
        if = {
          limit = { original_tag = DRG }
          country_event = { id = changelings.905 }
          break = yes
        }
        if = {
          limit = { original_tag = GFF }
          country_event = { id = changelings.906 }
          break = yes
        }
        if = {
          limit = { original_tag = GFF }
          country_event = { id = changelings.906 }
          break = yes
        }
        if = {
          limit = { original_tag = OLE }
          country_event = { id = olenia.718 }
          break = yes
        }
        if = {
          limit = { original_tag = CRY }
          country_event = { id = crystalemp.23 }
          break = yes
        }
        if = {
          limit = { original_tag = EQS }
          country_event = { id = equestriachn.3 }
          break = yes
        }
        if = {
          limit = { original_tag = STG }
          country_event = { id = stalliongrad.98 }
          break = yes
        }
        if = {
          limit = { original_tag = YAK }
          country_event = { id = yakistan.12 }
          break = yes
        }
        if = {
          limit = { original_tag = JAK }
          country_event = { id = yakistan.13 }
          break = yes
        }
      }
      if = {
        limit = { original_tag = CHN overlord = { has_government = fascism } }
        country_event = { id = solarempire.906 }
      }
      if = {
        limit = {
          FROM = {
            original_tag = SOL
            has_government = fascism
           }
        }
        if = {
          limit = { original_tag = CRY }
          FROM = {
            set_country_flag = SOL_twilight_unavailable
            set_country_flag = SOL_twilight_governor
            set_autonomy = { target = ROOT autonomy_state = autonomy_reichskommissariat }
          }
          set_cosmetic_tag = CRY_SOL
          add_autonomy_ratio = { value = -0.20 }
          set_country_flag = CRY_solar_governorship
          set_party_name = { ideology = fascism long_name = SOL_fascism_party_long name = SOL_fascism_party }
          if = {
            limit = { NOT = { has_global_flag = SOL_twilight_converted } }
            create_country_leader = {
              name = "Nameless Busybody"
              #desc = "TWILIGHT_DESC"
              #picture = "TwilightSunrise.tga"
              expire = "1965.1.1"
              ideology = fascism_ideology
              traits = {
              }
            }
            else = {
              create_country_leader = {
                name = "Grand Inquisitor Sunrise Sparkle"
                #desc = "TWILIGHT_DESC"
                picture = "TwilightSunrise.tga"
                expire = "1965.1.1"
                ideology = fascism_ideology
                traits = {
                  lady_inquisitor
                }
              }
            }
          }
          break = yes
        }
      }
      if = {
        limit = {
          FROM = {
            OR = {
              original_tag = EQS
              original_tag = SOL
            }
           }
        }
        if = {
          limit = {
            original_tag = CRY
            NOT = {
              has_idea = equestrian_overlord
              has_idea = equestrian_overlord2
            }
          }
          if = {
            limit = { has_completed_focus = CRY_eqsengineers }
            add_ideas = equestrian_overlord2
            else = {
              add_ideas = equestrian_overlord
            }
          }
        }
      }
      if = {
        limit = {
          original_tag = EQC
          FROM = {
            OR = {
              original_tag = EQS
              original_tag = NLR
              original_tag = SOL
            }
          }
        }
        country_event = equestriancolony.1
      }
    }
  }

  #ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_annex = {
		effect = {
			if = {
        limit = {
          original_tag = OLE
          NOT = { tag = OLE }
          FROM = { original_tag = OLE }
        }
        set_cosmetic_tag = OLE_CWWON
      }

      if = {
        limit = {
          tag = CHN
          FROM = { original_tag = OLE }
        }
      FROM = { set_country_flag = OLE_was_annexed }
      }

      if = {
        limit = {
          original_tag = SOL
          FROM = {
            has_country_flag = EQS_CRY_has_twilight
            original_tag = EQS
          }
        }
        news_event = solarempire.22
      }
      if = {
        limit = {
          original_tag = SOL
          FROM = {
            has_country_flag = EQS_CRY_has_twilight
            original_tag = CRY
          }
        }
        news_event = solarempire.26
      }
		}
	}

  on_civil_war_end = {
		effect = {
			#
		}
	}
on_capitulation = {
  effect = {
    if = {
      limit = {
        tag = EQP
      }
      EQS = { annex_country = { target = EQP } }
    }
    if = {
      limit = {
        original_tag = EQS
        has_country_flag = EQS_CRY_has_twilight
        FROM = { original_tag = SOL }
      }
      FROM = { news_event = solarempire.22 }
    }
    if = {
      limit = {
        original_tag = CRY
        has_country_flag = EQS_CRY_has_twilight
        FROM = { original_tag = SOL }
      }
      FROM = { news_event = solarempire.26 }
    }
  }
}
#ROOT is free nation FROM is releaser
on_release_as_free = {
  effect = {
    if = {
      limit = {
        OR = {
          has_idea = dummy_idea_society
          #has_idea = modern_society
          NOT = { has_idea_with_trait = society_idea }
        }
        FROM = {
          OR = {
            has_idea = outdated_industry
            has_idea = pre_industrial_society
            has_idea = agrarian_society
            has_idea = tribal_society
            has_idea = detached_country
          }
        }
      }
      FROM = { ROOT = { transfer_society_ideas = yes } }
      else = {
        add_ideas = modern_society
      }
    }
    if = {
      limit = {
        OR = {
          has_idea = dummy_idea_science
          #has_idea = modern_society
          NOT = { has_idea_with_trait = science_idea }
        }
        FROM = {
          OR = {
            has_idea = poor_science_base
            has_idea = better_science_base
            has_idea = big_science_base
          }
        }
      }
      FROM = { ROOT = { transfer_science_ideas = yes } }
      else = {
        add_ideas = proper_science_base
      }
    }
  }
}
on_government_change = {
    effect = {
      #Make sure Soviet can always create factions
      if = {
        limit = {
          original_tag = ROOT
          has_idea = outdated_industry
        }
        add_ideas = outdated_industry
      }
    }
  }
